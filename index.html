<script>
  document.getElementById('upload-form').addEventListener('submit', function (e) {
    e.preventDefault();

    const file = document.getElementById('file').files[0];
    if (!file) {
      alert('Por favor selecciona un archivo');
      return;
    }

    const reader = new FileReader();

    reader.onload = function (e) {
      const data = new Uint8Array(e.target.result);
      const workbook = XLSX.read(data, { type: 'array' });

      // Suponemos que los datos estÃ¡n en la primera hoja
      const sheet = workbook.Sheets[workbook.SheetNames[0]];
      const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

      mostrarTabla(jsonData);
    };

    reader.readAsArrayBuffer(file);
  });

  function mostrarTabla(data) {
    const resumen = document.getElementById('resumen');
    resumen.innerHTML = "";

    const table = document.createElement('table');
    table.style.borderCollapse = "collapse";
    table.style.width = "100%";

    data.forEach((row, index) => {
      const tr = document.createElement('tr');

      row.forEach(cell => {
        const td = document.createElement(index === 0 ? 'th' : 'td');
        td.textContent = cell;
        td.style.border = "1px solid #ccc";
        td.style.padding = "8px";
        td.style.background = index === 0 ? "#007bff" : "#fff";
        td.style.color = index === 0 ? "#fff" : "#333";
        tr.appendChild(td);
      });

      table.appendChild(tr);
    });

    resumen.appendChild(table);
  }
</script>
